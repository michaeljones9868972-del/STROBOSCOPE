let MAX_INIT_SIZE,MAX_ANGLE_STEP, SIZE_MULT, MIN_SIZE;
let initSize,initAngle,initColIndex;
let url = "https://coolors.co/app/9AA8A8-466A44-E0D5BE-E0908D-C7495C-ffffff-680003-BC0000-F5704A-EFB9AD-828D00";
let cols;

function setup() {
	createCanvas(windowWidth, windowHeight);
	rectMode(CENTER);
	noStroke();
	cols = createCols(url);
	//init param
	MAX_INIT_SIZE = max(width,height)*0.3;
	MAX_ANGLE_STEP = PI/20;
	SIZE_MULT = 0.88;
	MIN_SIZE = 12;
	initSize = MAX_INIT_SIZE;
	initAngle = 0;
	initColIndex = 0;
}

function draw() {
	background(0);
	
	let count = sin(frameCount/150);
	let angleStep =MAX_ANGLE_STEP * count;
	let colIndex = initColIndex;
	let size = initSize;
	let angle = initAngle;
	
	while(size > MIN_SIZE)
	{
		push();
		translate(width/2,height/2);
		rotate(angle);
		fill(cols[colIndex % cols.length]);
		rect(0,0,size,size,size*1.5);
		pop();
		angle += angleStep * map(size,MIN_SIZE,MAX_INIT_SIZE,1,0,false);
		size*= SIZE_MULT;
		colIndex ++;
	}
	
	initSize -= MAX_INIT_SIZE*0.0013*(10+abs(count));
	initAngle += angleStep*0.1;
	
	if(initSize < MAX_INIT_SIZE*SIZE_MULT)
	{
		initSize/=SIZE_MULT;
		initColIndex = (initColIndex + cols.length -1)%cols.length;
	}
}


function createCols(_url) {
  let slash_index = _url.lastIndexOf('/');
  let pallate_str = _url.slice(slash_index + 1);
  let arr = pallate_str.split('-');
  for (let i = 0; i < arr.length; i++) {
    arr[i] = '#' + arr[i];
  }
  return arr;
}
