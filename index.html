<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>–ü–æ–≥—Ä—É–∂–µ–Ω–∏–µ –≤ –±–µ—Å–∫–æ–Ω–µ—á–Ω–æ—Å—Ç—å</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.7.0/p5.min.js"></script>
  <style>
    body {
      margin: 0;
      padding: 0;
      overflow: hidden;
      background: #000;
      font-family: Arial, sans-serif;
    }
    canvas {
      display: block;
    }
    .overlay {
      position: fixed;
      top: 0; left: 0; width: 100%; height: 100%;
      background: rgba(0,0,0,0.8);
      color: white;
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      font-size: 24px;
      text-align: center;
      z-index: 10;
      transition: opacity 1s ease;
    }
    .overlay.hide {
      opacity: 0;
      pointer-events: none;
    }
    button {
      margin-top: 20px;
      padding: 12px 30px;
      font-size: 18px;
      background: #D5FB00;
      color: #223C20;
      border: none;
      border-radius: 30px;
      cursor: pointer;
      transition: 0.3s;
    }
    button:hover {
      background: #DE60CA;
      color: white;
    }
  </style>
</head>
<body>

  <div class="overlay" id="overlay">
    <h2>üåÄ –ü–æ–≥—Ä—É–∑–∏—Ç—å—Å—è –≤ –±–µ—Å–∫–æ–Ω–µ—á–Ω–æ—Å—Ç—å</h2>
    <p>–ß–µ—Ä–µ–∑ 3 —Å–µ–∫—É–Ω–¥—ã –∞–∫—Ç–∏–≤–∏—Ä—É–µ—Ç—Å—è –ø–æ–ª–Ω–æ—ç–∫—Ä–∞–Ω–Ω—ã–π —Ä–µ–∂–∏–º</p>
    <button id="fullscreenBtn" disabled>–ü–æ–≥—Ä—É–∑–∏—Ç—å—Å—è</button>
  </div>

  <script>
    let MAX_INIT_SIZE, MAX_ANGLE_STEP, SIZE_MULT, MIN_SIZE;
    let initSize, initAngle, initColIndex;
    let url = "https://coolors.co/app/223C20-4C8D26-D5FB00-DE60CA-882380";
    let cols;
    let isFullscreen = false;
    let music; // –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è –¥–ª—è –∞—É–¥–∏–æ
    let breathFactor = 0; // –¥–ª—è —ç—Ñ—Ñ–µ–∫—Ç–∞ "–¥—ã—Ö–∞–Ω–∏—è"

    function preload() {
      // –ó–∞–≥—Ä—É–∂–∞–µ–º –º—É–∑—ã–∫—É (–∏—Å–ø–æ–ª—å–∑—É–µ–º –≤–Ω–µ—à–Ω—é—é —Å—Å—ã–ª–∫—É –Ω–∞ –∞—Ç–º–æ—Å—Ñ–µ—Ä–Ω—ã–π —Ç—Ä–µ–∫)
      // –ü—Ä–∏–º–µ—Ä: —Ç–∏—Ö–∞—è –º–µ–¥–∏—Ç–∞—Ç–∏–≤–Ω–∞—è –º—É–∑—ã–∫–∞ (–Ω–µ –∑–∞–±—É–¥—å –∑–∞–º–µ–Ω–∏—Ç—å –Ω–∞ —Å–≤–æ—é!)
      const musicURL = "https://ice2.somafm.com/n5md-128-mp3"; // –±–µ—Å–ø–ª–∞—Ç–Ω–∞—è –∞—Ç–º–æ—Å—Ñ–µ—Ä–∞
      music = loadSound(musicURL, () => {
        console.log("–ú—É–∑—ã–∫–∞ –∑–∞–≥—Ä—É–∂–µ–Ω–∞");
      }, () => {
        console.log("–ù–µ —É–¥–∞–ª–æ—Å—å –∑–∞–≥—Ä—É–∑–∏—Ç—å –º—É–∑—ã–∫—É (–≤–æ–∑–º–æ–∂–Ω–æ, –±–ª–æ–∫–∏—Ä–æ–≤–∫–∞)");
      });
    }

    function setup() {
      createCanvas(windowWidth, windowHeight);
      rectMode(CENTER);
      noStroke();
      cols = createCols(url);

      MAX_INIT_SIZE = max(width, height) * 0.6; // –±–æ–ª—å—à–µ ‚Äî —É—Ö–æ–¥–∏—Ç –∑–∞ –∫—Ä–∞—è
      MAX_ANGLE_STEP = PI / 30;
      SIZE_MULT = 0.92; // –º–µ–¥–ª–µ–Ω–Ω–µ–µ —É–º–µ–Ω—å—à–µ–Ω–∏–µ ‚Äî –¥–æ–ª—å—à–µ "–¥—ã—à–∏—Ç"
      MIN_SIZE = 5;

      initSize = MAX_INIT_SIZE;
      initAngle = 0;
      initColIndex = 0;

      // –í–∫–ª—é—á–∞–µ–º –º—É–∑—ã–∫—É –ø—Ä–∏ –∫–ª–∏–∫–µ (–æ–±—Ö–æ–¥ –∞–≤—Ç–æ–≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏—è)
      document.getElementById('fullscreenBtn').addEventListener('click', () => {
        if (music && !music.isPlaying()) {
          music.setVolume(0.7);
          music.loop(); // –∑–∞—Ü–∏–∫–ª–∏—Ç—å
        }
      });

      setTimeout(() => {
        document.getElementById('fullscreenBtn').disabled = false;
        document.getElementById('fullscreenBtn').innerText = "‚ñ∂ –ü–æ–≥—Ä—É–∑–∏—Ç—å—Å—è";
      }, 3000);
    }

    function draw() {
      background(0);

      // –≠—Ñ—Ñ–µ–∫—Ç "–¥—ã—Ö–∞–Ω–∏—è" ‚Äî –ø–ª–∞–≤–Ω–æ–µ –∏–∑–º–µ–Ω–µ–Ω–∏–µ —Ä–∞–∑–º–µ—Ä–∞
      breathFactor = 0.95 + 0.05 * sin(frameCount * 0.02); // 0.95 ‚Üí 1.0

      if (document.getElementById('overlay').style.display === 'none' || !document.getElementById('overlay').offsetParent) {
        let count = sin(frameCount / 180);
        let angleStep = MAX_ANGLE_STEP * (0.8 + 0.2 * cos(frameCount * 0.01));
        let colIndex = initColIndex;
        let size = initSize * breathFactor; // –¥—ã—Ö–∞–Ω–∏–µ –Ω–∞ —Å—Ç–∞—Ä—Ç–µ
        let angle = initAngle;

        // –†–∏—Å—É–µ–º –∫—Ä—É–≥–∏, –≤—ã—Ö–æ–¥—è—â–∏–µ –∑–∞ –ø—Ä–µ–¥–µ–ª—ã —ç–∫—Ä–∞–Ω–∞
        while (size > MIN_SIZE * 0.5) {
          push();
          translate(width / 2, height / 2);
          rotate(angle);

          // –¶–≤–µ—Ç —Å –ø–ª–∞–≤–Ω—ã–º —Å–¥–≤–∏–≥–æ–º
          fill(cols[colIndex % cols.length]);
          noFill(); // —Ç–æ–ª—å–∫–æ –∫–æ–Ω—Ç—É—Ä
          stroke(cols[colIndex % cols.length]);
          strokeWeight(1.2);
          
          // –ö—Ä—É–≥–∏ –±–æ–ª—å—à–µ —ç–∫—Ä–∞–Ω–∞
          ellipse(0, 0, size, size * 0.8);

          pop();

          angle += angleStep * map(size, MIN_SIZE, MAX_INIT_SIZE * 1.5, 1, 0.1, true);
          size *= SIZE_MULT;
          colIndex++;
        }

        // –ü–ª–∞–≤–Ω–æ–µ –∏–∑–º–µ–Ω–µ–Ω–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤
        initSize += random(-0.3, 0.3); // –ª—ë–≥–∫–∞—è –Ω–µ—Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å ‚Äî –∫–∞–∫ –¥—ã—Ö–∞–Ω–∏–µ –≤—Å–µ–ª–µ–Ω–Ω–æ–π
        initSize = constrain(initSize, MAX_INIT_SIZE * 0.9, MAX_INIT_SIZE * 1.1);
        initAngle += angleStep * 0.05;
      }
    }

    function enterFullscreen() {
      const elem = document.documentElement;
      if (elem.requestFullscreen) {
        elem.requestFullscreen();
      } else if (elem.webkitRequestFullscreen) {
        elem.webkitRequestFullscreen();
      } else if (elem.msRequestFullscreen) {
        elem.msRequestFullscreen();
      }

      document.getElementById('overlay').style.display = 'none';
      isFullscreen = true;

      // –ó–∞–ø—É—Å–∫–∞–µ–º –º—É–∑—ã–∫—É –ø–æ—Å–ª–µ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è
      if (music) music.loop();
    }

    function mouseMoved() {
      if (isFullscreen) showExitHint();
    }

    function keyPressed() {
      if (keyCode === ESC || keyCode === 32) exitFullscreen();
    }

    function showExitHint() {
      const overlay = document.getElementById('overlay');
      overlay.innerHTML = `
        <h2>üåÄ –í—ã—Ö–æ–¥ –∏–∑ –ø–æ–≥—Ä—É–∂–µ–Ω–∏—è</h2>
        <p>–ù–∞–∂–º–∏—Ç–µ ESC –∏–ª–∏ –ø—Ä–æ–±–µ–ª</p>
        <button onclick="exitFullscreen()">–í—ã–π—Ç–∏</button>
      `;
      overlay.style.display = 'flex';
    }

    function exitFullscreen() {
      if (document.exitFullscreen) document.exitFullscreen();
      else if (document.webkitExitFullscreen) document.webkitExitFullscreen();
      else if (document.msExitFullscreen) document.msExitFullscreen();

      if (music) music.stop();
      document.getElementById('overlay').style.display = 'flex';
      isFullscreen = false;
    }

    function windowResized() {
      resizeCanvas(windowWidth, windowHeight);
      MAX_INIT_SIZE = max(width, height) * 0.6;
    }

    function createCols(_url) {
      let slash_index = _url.lastIndexOf('/');
      let palette_str = _url.slice(slash_index + 1);
      let arr = palette_str.split('-');
      for (let i = 0; i < arr.length; i++) {
        arr[i] = '#' + arr[i];
      }
      return arr;
    }
  </script>
</body>
</html>
